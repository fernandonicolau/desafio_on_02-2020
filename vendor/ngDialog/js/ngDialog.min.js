!function(e,o){"undefined"!=typeof module&&module.exports?module.exports=o(require("angular")):"function"==typeof define&&define.amd?define(["angular"],o):o(e.angular)}(this,function(e){"use strict";var o,n=e.module("ngDialog",[]),a=e.element,l=e.isDefined,i=(document.body||document.documentElement).style,t=l(i.animation)||l(i.WebkitAnimation)||l(i.MozAnimation)||l(i.MsAnimation)||l(i.OAnimation),s="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",c=!1;return n.provider("ngDialog",function(){var n=this.defaults={className:"ngdialog-theme-default",plain:!1,showClose:!0,closeByDocument:!0,closeByEscape:!0,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1,overlay:!0,cache:!0};this.setForceBodyReload=function(e){c=e||!1},this.setDefaults=function(o){e.extend(n,o)};var l,i=0,r=0,d={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller",function(g,u,p,m,f,C,D,v,y){var h=g.find("body");c&&C.$on("$locationChangeSuccess",function(){h=g.find("body")});var $={onDocumentKeydown:function(e){27===e.keyCode&&b.close("$escape")},setBodyPadding:function(e){var o=parseInt(h.css("padding-right")||0,10);h.css("padding-right",o+e+"px"),h.data("ng-dialog-original-padding",o)},resetBodyPadding:function(){var e=h.data("ng-dialog-original-padding");e?h.css("padding-right",e+"px"):h.css("padding-right","")},performCloseDialog:function(e,n){var a=e.attr("id");if(void 0!==v.Hammer){var i=o.hammerTime;i.off("tap",l),i.destroy&&i.destroy(),delete o.hammerTime}else e.unbind("click");1===r&&h.unbind("keydown"),e.hasClass("ngdialog-closing")||(r-=1),C.$broadcast("ngDialog.closing",e),r=0>r?0:r,t?(o.$destroy(),e.unbind(s).bind(s,function(){e.remove(),0===r&&(h.removeClass("ngdialog-open"),$.resetBodyPadding()),C.$broadcast("ngDialog.closed",e)}).addClass("ngdialog-closing")):(o.$destroy(),e.remove(),0===r&&(h.removeClass("ngdialog-open"),$.resetBodyPadding()),C.$broadcast("ngDialog.closed",e)),d[a]&&(d[a].resolve({id:a,value:n,$dialog:e,remainingDialogs:r}),delete d[a])},closeDialog:function(o,n){var a=o.data("$ngDialogPreCloseCallback");if(a&&e.isFunction(a)){var l=a.call(o,n);e.isObject(l)?l.closePromise?l.closePromise.then(function(){$.performCloseDialog(o,n)}):l.then(function(){$.performCloseDialog(o,n)},function(){}):l&&$.performCloseDialog(o,n)}else $.performCloseDialog(o,n)}},b={open:function(t){function s(e,o){return f.get(e,o||{}).then(function(e){return e.data||""})}var c,g,k,B=this,w=e.copy(n);return t=t||{},e.extend(w,t),i+=1,B.latestID="ngdialog"+i,d[B.latestID]=c=m.defer(),o=e.isObject(w.scope)?w.scope.$new():C.$new(),m.when(function(o){return o?e.isString(o)&&w.plain?o:"boolean"!=typeof w.cache||w.cache?u.get(o)||s(o,{cache:!0}):s(o,{cache:!1}):"Empty template"}(w.template||w.templateUrl)).then(function(n){if(u.put(w.template||w.templateUrl,n),w.showClose&&(n+='<div class="ngdialog-close"></div>'),B.$result=g=a('<div id="ngdialog'+i+'" class="ngdialog"></div>'),g.html(w.overlay?'<div class="ngdialog-overlay"></div><div class="ngdialog-content">'+n+"</div>":'<div class="ngdialog-content">'+n+"</div>"),w.data&&e.isString(w.data)){var t=w.data.replace(/^\s*/,"")[0];o.ngDialogData="{"===t||"["===t?e.fromJson(w.data):w.data}else w.data&&e.isObject(w.data)&&(o.ngDialogData=w.data);if(w.controller&&(e.isString(w.controller)||e.isArray(w.controller)||e.isFunction(w.controller))){var s=y(w.controller,{$scope:o,$element:g});g.data("$ngDialogControllerController",s)}var c;(w.className&&g.addClass(w.className),k=w.appendTo&&e.isString(w.appendTo)?e.element(document.querySelector(w.appendTo)):h,w.preCloseCallback)&&(e.isFunction(w.preCloseCallback)?c=w.preCloseCallback:e.isString(w.preCloseCallback)&&o&&(e.isFunction(o[w.preCloseCallback])?c=o[w.preCloseCallback]:o.$parent&&e.isFunction(o.$parent[w.preCloseCallback])?c=o.$parent[w.preCloseCallback]:C&&e.isFunction(C[w.preCloseCallback])&&(c=C[w.preCloseCallback])),c&&g.data("$ngDialogPreCloseCallback",c));(o.closeThisDialog=function(e){$.closeDialog(g,e)},D(function(){p(g)(o);var e=v.innerWidth-h.prop("clientWidth");h.addClass("ngdialog-open");var n=e-(v.innerWidth-h.prop("clientWidth"));n>0&&$.setBodyPadding(n),k.append(g),w.name?C.$broadcast("ngDialog.opened",{dialog:g,name:w.name}):C.$broadcast("ngDialog.opened",g)}),w.closeByEscape&&h.bind("keydown",$.onDocumentKeydown),w.closeByNavigation&&C.$on("$locationChangeSuccess",function(){$.closeDialog(g)}),l=function(e){var o=!!w.closeByDocument&&a(e.target).hasClass("ngdialog-overlay"),n=a(e.target).hasClass("ngdialog-close");(o||n)&&b.close(g.attr("id"),n?"$closeButton":"$document")},void 0!==v.Hammer)?(o.hammerTime=v.Hammer(g[0])).on("tap",l):g.bind("click",l);return r+=1,b}),{id:"ngdialog"+i,closePromise:c.promise,close:function(e){$.closeDialog(g,e)}}},openConfirm:function(o){var n=m.defer(),l={closeByEscape:!1,closeByDocument:!1};e.extend(l,o),l.scope=e.isObject(l.scope)?l.scope.$new():C.$new(),l.scope.confirm=function(e){n.resolve(e);var o=a(document.getElementById(i.id));$.performCloseDialog(o,e)};var i=b.open(l);return i.closePromise.then(function(e){return e?n.reject(e.value):n.reject()}),n.promise},close:function(e,o){var n=a(document.getElementById(e));return n.length?$.closeDialog(n,o):b.closeAll(o),b},closeAll:function(o){var n=document.querySelectorAll(".ngdialog");e.forEach(n,function(e){$.closeDialog(a(e),o)})},getDefaults:function(){return n}};return b}]}),n.directive("ngDialog",["ngDialog",function(o){return{restrict:"A",scope:{ngDialogScope:"="},link:function(n,a,l){a.on("click",function(a){a.preventDefault();var i=e.isDefined(n.ngDialogScope)?n.ngDialogScope:"noScope";e.isDefined(l.ngDialogClosePrevious)&&o.close(l.ngDialogClosePrevious);var t=o.getDefaults();o.open({template:l.ngDialog,className:l.ngDialogClass||t.className,controller:l.ngDialogController,scope:i,data:l.ngDialogData,showClose:"false"!==l.ngDialogShowClose&&("true"===l.ngDialogShowClose||t.showClose),closeByDocument:"false"!==l.ngDialogCloseByDocument&&("true"===l.ngDialogCloseByDocument||t.closeByDocument),closeByEscape:"false"!==l.ngDialogCloseByEscape&&("true"===l.ngDialogCloseByEscape||t.closeByEscape),preCloseCallback:l.ngDialogPreCloseCallback||t.preCloseCallback})})}}}]),n});